---
title: "CLI Reference"
---

```{bash}
#| include: false
# Set up PATH to include the scsv binary for examples
export PATH="../build:$PATH"
```

## Overview

The `scsv` command line tool provides a user-friendly way to work with CSV files using the high-performance simdcsv parser. It supports common operations like counting rows, displaying data, selecting columns, and detecting file formats.

## Basic Usage

```bash
scsv <command> [options] [csvfile]
```

If `csvfile` is omitted or `-` is specified, scsv reads from standard input.

## Commands

| Command | Description |
|---------|-------------|
| `count` | Count the number of rows |
| `head` | Display the first N rows (default: 10) |
| `select` | Select specific columns by name or index |
| `info` | Display information about the CSV file |
| `pretty` | Pretty-print the CSV with aligned columns |
| `dialect` | Detect and display the CSV dialect (delimiter, quoting, etc.) |

## Options

### General Options

| Option | Description |
|--------|-------------|
| `-h` | Show help message |
| `-v` | Show version information |

### Data Options

| Option | Description | Default |
|--------|-------------|---------|
| `-n <num>` | Number of rows (for head/pretty) | 10 |
| `-c <cols>` | Comma-separated column names or indices (for select) | - |
| `-H` | No header row in input | (header assumed) |

### Performance Options

| Option | Description | Default |
|--------|-------------|---------|
| `-t <threads>` | Number of threads (1-255) | auto (hardware concurrency) |

### Dialect Options

| Option | Description | Default |
|--------|-------------|---------|
| `-d <delim>` | Field delimiter: `comma`, `tab`, `semicolon`, `pipe`, or any single character. Disables auto-detection when specified. | auto-detect |
| `-q <char>` | Quote character | `"` |

### Output Options

| Option | Description | Commands |
|--------|-------------|----------|
| `-j` | Output in JSON format | dialect |

## Input and Output Formats

### Input Sources

scsv can read CSV data from multiple sources:

- **Files**: Provide the path to a CSV file
- **stdin**: Omit the filename or use `-` to read from standard input

### Output Formats

- **CSV output** (head, select): Valid CSV maintaining the input delimiter
- **Plain text** (count): Single number
- **Structured text** (info, pretty): Human-readable formatted output
- **JSON** (dialect -j): Machine-readable format for scripting

### Supported Delimiters

| Name | Character | Example Usage |
|------|-----------|---------------|
| comma | `,` | `-d comma` or `-d ,` |
| tab | `\t` | `-d tab` |
| semicolon | `;` | `-d semicolon` or `-d ";"` |
| pipe | `\|` | `-d pipe` or `-d "\|"` |
| any character | varies | `-d :` |

## Examples

The examples below use test data files from the simdcsv repository.

### Counting Rows

Count the number of data rows (excluding header):

```{bash}
scsv count ../test/data/real_world/contacts.csv
```

### Viewing First Rows

Display the first rows:

```{bash}
scsv head ../test/data/real_world/contacts.csv
```

Display the first 2 rows:

```{bash}
scsv head -n 2 ../test/data/real_world/contacts.csv
```

### Selecting Columns

Select columns by name:

```{bash}
scsv select -c Name,Email ../test/data/real_world/contacts.csv
```

Select columns by index (0-based):

```{bash}
scsv select -c 0,2 ../test/data/real_world/contacts.csv
```

### File Information

Display metadata about a CSV file:

```{bash}
scsv info ../test/data/real_world/contacts.csv
```

### Pretty Printing

Display CSV data in a formatted table:

```{bash}
scsv pretty ../test/data/real_world/contacts.csv
```

Limit to first 2 rows:

```{bash}
scsv pretty -n 2 ../test/data/real_world/contacts.csv
```

### Dialect Detection

Detect the CSV dialect (delimiter, quoting style, line endings):

```{bash}
scsv dialect ../test/data/separators/semicolon.csv
```

Get dialect information in JSON format for scripting:

```{bash}
scsv dialect -j ../test/data/separators/tab.csv
```

### Working with Different Delimiters

By default, scsv auto-detects the delimiter. You can also specify it explicitly.

Parse a tab-separated file with explicit delimiter:

```{bash}
scsv count -d tab ../test/data/separators/tab.csv
```

Parse a semicolon-separated file (common in European locales):

```{bash}
scsv head -d semicolon ../test/data/separators/semicolon.csv
```

Parse a pipe-separated file:

```{bash}
scsv select -d pipe -c 0,1 ../test/data/separators/pipe.csv
```

### Working with Quoted Fields

CSV files often contain fields with special characters that require quoting:

```{bash}
scsv pretty ../test/data/quoted/embedded_separators.csv
```

Fields containing embedded quotes (escaped as `""`):

```{bash}
scsv pretty ../test/data/quoted/escaped_quotes.csv
```

### Multi-threaded Parsing

By default, scsv uses all available CPU cores for parallel parsing. You can limit the thread count if needed:

```{bash}
scsv count -t 4 ../test/data/real_world/contacts.csv
```

By default, scsv automatically uses the number of hardware threads available.

### Files Without Headers

When the CSV has no header row, use `-H`:

```{bash}
scsv count -H ../test/data/basic/simple_no_header.csv
```

```{bash}
scsv select -H -c 0,1,2 ../test/data/basic/simple_no_header.csv
```

### Reading from stdin

Pipe data directly to scsv:

```{bash}
cat ../test/data/basic/simple.csv | scsv count
```

Use `-` to explicitly read from stdin:

```{bash}
scsv head - < ../test/data/basic/simple.csv
```

## Common Workflows

### Inspecting an Unknown CSV File

When working with a CSV file of unknown format:

```bash
# First, detect the dialect
scsv dialect data.csv

# Then view the structure and sample data
scsv info data.csv
scsv pretty -n 5 data.csv
```

### Extracting Specific Columns

Extract columns for further processing:

```bash
# By name (requires header row)
scsv select -c id,email,status data.csv > extracted.csv

# By index (works with or without header)
scsv select -c 0,3,5 data.csv > extracted.csv
```

### Processing Large Files

For large files, scsv automatically uses multiple threads:

```bash
# Count rows quickly (uses optimized SIMD row counter)
scsv count large_file.csv

# Explicitly set thread count if needed
scsv count -t 8 large_file.csv
```

### Pipeline Integration

scsv works well in Unix pipelines:

```bash
# Filter and process
cat data.csv | scsv select -c name,email | grep "@company.com"

# Chain with other tools
scsv head -n 100 huge.csv | scsv pretty
```

### Working with Non-Standard Formats

For files with non-standard delimiters:

```bash
# Colon-separated (e.g., /etc/passwd format)
scsv count -d : passwords.txt

# Custom single-character delimiter
scsv head -d "^" caret_delimited.csv
```

## Performance Tips

1. **Thread count**: By default, scsv uses all available hardware threads. For large files (>1MB), this provides the best performance. Use `-t 1` to force single-threaded operation if needed.

2. **Row counting**: The `count` command uses an optimized SIMD algorithm that doesn't build a full index, making it significantly faster than other commands for simply counting rows.

3. **Auto-detection overhead**: Auto-detection adds minimal overhead for the first few KB of data. If processing many files with known formats, specifying `-d` explicitly can provide a small performance improvement.

4. **stdin vs files**: Reading from files allows memory mapping and parallel processing. When possible, prefer file arguments over stdin for large datasets.

## Exit Codes

| Code | Meaning |
|------|---------|
| 0 | Success |
| 1 | Error (invalid arguments, file not found, parse error, or dialect detection failure) |

## Dialect Detection Details

The `dialect` command analyzes the CSV structure and reports:

- **Delimiter**: The field separator character
- **Quote**: The character used for quoting fields (typically `"`)
- **Escape**: How quotes are escaped within fields (`double-quote` for `""` or `backslash` for `\"`)
- **Line ending**: LF (Unix), CRLF (Windows), CR (old Mac), or mixed
- **Has header**: Whether the first row appears to be a header
- **Columns**: Number of columns detected
- **Confidence**: Detection confidence level (0-100%)

The command also outputs suggested CLI flags for use with other scsv commands.
